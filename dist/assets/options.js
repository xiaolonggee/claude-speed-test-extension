import{c as C,r as o,j as e,e as u,u as E,L as B,C as f,a as v,b as y,k as b,d as N,S,B as j,D as F,h as V,R as _}from"./index.js";const O=C("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),$=C("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),q=C("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),i=o.forwardRef(({className:a,type:n,...l},d)=>e.jsx("input",{type:n,className:u("flex h-10 w-full rounded-md border border-input bg-white px-3 py-2 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-60",a),ref:d,...l}));i.displayName="Input";const r=o.forwardRef(({className:a,...n},l)=>e.jsx("label",{ref:l,className:u("text-sm font-medium leading-none text-muted-foreground peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a),...n}));r.displayName="Label";const P=o.forwardRef(({className:a,checked:n,disabled:l,onCheckedChange:d,...h},p)=>e.jsx("button",{type:"button",role:"switch","aria-checked":n,ref:p,disabled:l,onClick:()=>d==null?void 0:d(!n),className:u("relative inline-flex h-6 w-10 shrink-0 cursor-pointer items-center rounded-full border border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-60",n?"bg-primary":"bg-muted",a),...h,children:e.jsx("span",{className:u("pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform",n?"translate-x-4":"translate-x-1")})}));P.displayName="Switch";const D=o.forwardRef(({className:a,...n},l)=>e.jsx("textarea",{className:u("flex min-h-[100px] w-full rounded-md border border-input bg-white px-3 py-2 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-60",a),ref:l,...n}));D.displayName="Textarea";const G={default:"bg-primary text-primary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",muted:"bg-muted text-muted-foreground",outline:"border border-border text-foreground"},w=o.forwardRef(({className:a,variant:n="default",...l},d)=>e.jsx("span",{ref:d,className:u("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium",G[n],a),...l}));w.displayName="Badge";const U=()=>{const{config:a,setConfig:n,persist:l,loading:d,saving:h,error:p}=E(),[k,R]=o.useState(null),I=["claude-3-5-haiku-20241022","claude-3-5-sonnet-20241022","claude-haiku-4-5-20251001","claude-opus-4-20250514","claude-sonnet-4-20250514","claude-sonnet-4-5","claude-3-7-sonnet-20250219","claude-opus-4-1-20250805","claude-opus-4-5-20251101","claude-sonnet-4-5-20250929"],T=o.useMemo(()=>a.routes.filter(s=>s.enabled).length,[a.routes]),K=["timeout","testCount","delayBetweenTests","maxConcurrentRoutes","maxConcurrentPerRoute","maxTokens"],c=s=>t=>{const g=K.includes(s),x=t.target.value,z=g?Number(x):x;n({...a,[s]:z})},m=(s,t,g)=>{n({...a,routes:a.routes.map(x=>x.id===s?{...x,[t]:g}:x)})},M=()=>{const s={id:`route-${Date.now()}`,name:"新线路",url:"",description:"",enabled:!0,authHeader:""};n({...a,routes:[...a.routes,s]})},A=s=>{a.routes.length!==1&&n({...a,routes:a.routes.filter(t=>t.id!==s)})},L=async()=>{await l(a),R(Date.now())},H=()=>{n({...F,routes:F.routes.map(s=>({...s}))}),R(null)};return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(B,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"加载中..."})]})}):e.jsx("div",{className:"min-h-screen px-5 py-6",children:e.jsxs("div",{className:"mx-auto flex max-w-5xl flex-col gap-5",children:[e.jsxs("header",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Claude API 测速 · 设置"}),e.jsx("h1",{className:"text-2xl font-semibold",children:"配置请求参数与线路"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"全局 Key、模型、并发、提示词，以及自定义第三方接口地址。保存后在弹窗直接测速。"}),p&&e.jsx("p",{className:"text-xs text-warning-foreground",children:p})]}),e.jsxs("div",{className:"grid gap-5 lg:grid-cols-[0.65fr_0.35fr]",children:[e.jsxs(f,{className:"glass-panel",children:[e.jsxs(v,{children:[e.jsx(y,{children:"请求与并发"}),e.jsx(b,{children:"这些配置直接决定测速的请求负载。"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"apiKey",children:"全局 API Key"}),e.jsx(i,{id:"apiKey",placeholder:"Bearer sk-...",value:a.apiKey,onChange:c("apiKey")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"建议包含 Bearer 前缀；单条线路也可以覆盖。"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"model",children:"模型 ID"}),e.jsx(S,{id:"model",value:a.model,onChange:c("model"),children:I.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"仅列出 Anthropic 10 个模型，可在此选择。"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"maxTokens",children:"max_tokens"}),e.jsx(i,{id:"maxTokens",type:"number",min:1,value:a.maxTokens,onChange:c("maxTokens")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"content",children:"提示词"}),e.jsx(D,{id:"content",rows:3,value:a.content,onChange:c("content")})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"timeout",children:"超时 (秒)"}),e.jsx(i,{id:"timeout",type:"number",min:1,value:a.timeout,onChange:c("timeout")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"testCount",children:"单线路次数"}),e.jsx(i,{id:"testCount",type:"number",min:1,value:a.testCount,onChange:c("testCount")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"delayBetweenTests",children:"两次间隔 (秒)"}),e.jsx(i,{id:"delayBetweenTests",type:"number",min:0,step:"0.1",value:a.delayBetweenTests,onChange:c("delayBetweenTests")})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"maxConcurrentRoutes",children:"同时跑的线路"}),e.jsx(i,{id:"maxConcurrentRoutes",type:"number",min:1,value:a.maxConcurrentRoutes,onChange:c("maxConcurrentRoutes")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"maxConcurrentPerRoute",children:"单线路并发"}),e.jsx(S,{id:"maxConcurrentPerRoute",value:String(a.maxConcurrentPerRoute),onChange:c("maxConcurrentPerRoute"),children:[1,2,3,4,5].map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"目前测速按顺序发起，预留并发参数方便后续扩展。"})]})]})]})]}),e.jsxs(f,{className:"glass-panel",children:[e.jsxs(v,{children:[e.jsx(y,{children:"操作"}),e.jsx(b,{children:"保存或恢复默认配置。"})]}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs(j,{className:"w-full",onClick:L,disabled:h,children:[h?e.jsx(B,{className:"h-4 w-4 animate-spin"}):e.jsx($,{className:"h-4 w-4"}),"保存配置"]}),e.jsx(j,{variant:"secondary",className:"w-full",onClick:H,children:"载入默认"}),k&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["已保存：",new Date(k).toLocaleTimeString()]})]})]})]}),e.jsxs(f,{className:"glass-panel",children:[e.jsxs(v,{children:[e.jsx(y,{children:"线路列表"}),e.jsxs(b,{children:["为不同第三方接口配置独立地址、描述和认证头。成功启用 ",T,"/",a.routes.length," 条。"]})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs(w,{variant:"muted",children:["已启用 ",T," 条"]}),e.jsxs(j,{variant:"secondary",size:"sm",onClick:M,children:[e.jsx(O,{className:"h-4 w-4"}),"新增线路"]})]}),e.jsx("div",{className:"space-y-3",children:a.routes.map(s=>e.jsxs("div",{className:"rounded-xl border border-border bg-white/90 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{checked:s.enabled,onCheckedChange:t=>m(s.id,"enabled",t)}),e.jsx("div",{className:"text-sm font-semibold",children:s.name}),e.jsx(w,{variant:s.enabled?"success":"muted",children:s.enabled?"启用":"停用"})]}),e.jsxs(j,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>A(s.id),disabled:a.routes.length===1,children:[e.jsx(q,{className:"h-4 w-4"}),"删除"]})]}),e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(r,{className:"text-xs",children:"名称"}),e.jsx(i,{value:s.name,onChange:t=>m(s.id,"name",t.target.value)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(r,{className:"text-xs",children:"描述"}),e.jsx(i,{value:s.description||"",onChange:t=>m(s.id,"description",t.target.value)})]}),e.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[e.jsx(r,{className:"text-xs",children:"接口地址"}),e.jsx(i,{value:s.url,onChange:t=>m(s.id,"url",t.target.value),placeholder:"https://.../v1/messages"})]}),e.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[e.jsx(r,{className:"text-xs",children:"认证头 (可覆盖全局)"}),e.jsx(i,{value:s.authHeader||"",onChange:t=>m(s.id,"authHeader",t.target.value),placeholder:"Bearer sk-xxx，留空则使用全局 Key"})]})]})]},s.id))})]})]})]})})};V.createRoot(document.getElementById("root")).render(e.jsx(_.StrictMode,{children:e.jsx(U,{})}));
